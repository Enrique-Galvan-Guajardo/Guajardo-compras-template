<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabla de productos</title>
    <!--Links to stylesheets-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="./public/css/index.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Hind:300,400,500,600,700&display=swap">
    
    <!--Links to javascript files-->
    <!--Bootstrap 5-->
    <script src="./public/js/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/89ee7a970b.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="test">
        <div class="card text-center product-card">
            <div class="card-header">
                <p>Solicitud de pedido</p>
              <ul class="nav nav-tabs card-header-tabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <a class="nav-link active" id="product-table-tab" data-toggle="tab" href="#product-table" role="tab" aria-controls="product-table" aria-selected="true">Añadir al pedido</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Estadística</a>
                    <div class="dropdown-menu">
                      <a class="dropdown-item" id="most-asked-product-table-tab" data-toggle="tab" href="#most-asked-product-table" role="tab" aria-controls="most-asked-product-table" aria-selected="false">Más pedidos</a>
                      <a class="dropdown-item" id="less-asked-product-table-tab" data-toggle="tab" href="#less-asked-product-table" role="tab" aria-controls="less-asked-product-table" aria-selected="false">Menos pedidos</a>
                      <div class="dropdown-divider"></div>
                      <a class="dropdown-item" id="match-failed-product-table-tab" data-toggle="tab" href="#match-failed-product-table" role="tab" aria-controls="match-failed-product-table" aria-selected="false">Productos que más han fallado en match</a>
                    </div>
                  </li>
              </ul>
            </div>
            <div class="card-body tab-content">
                <div class="tab-pane fade show active" id="product-table" role="tabpanel" aria-labelledby="product-table-tab">
                    <h5 class="card-title">Lista de productos</h5>
                    <table id="order-table" class="table table-striped table-hover table-responsive">
                        <thead class="thead-dark">
                          <tr>
                            <th scope="col">#</th>
                            <th scope="col">Nombre</th>
                            <th scope="col">Familia</th>
                            <th scope="col">Sub Familia</th>
                            <th scope="col">Cantidad</th>
                            <th scope="col">Presentación</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr id="product_item_1" class="row-item-added family-frutas-y-verduras">
                            <th scope="row"><div>1</div></th>
                            <td class="row-item-id">
                                <div>
                                    <svg class="icon-xl2 tomate-hd"></svg>
                                </div>
                                <p>Tomate</p>
                            </td>
                            <td>Frutas y Verduras</td>
                            <td>Verduras</td>
                            <td class="row-item-count hide-input">
                              <div class="input-group">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-info" type="button"><div>+</div></button>
                                </div>
                                <input id="product_item_1_count" type="number" class="form-control" placeholder="Ingresar cantidad" aria-label="Conjunto de botónes para producto" aria-describedby="Conjunto de botónes para cantidad de unidades" value="0">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-danger" type="button"><div>-</div></button>
                                </div>
                              </div>
                              <div class="my-2">
                                <div>x <span>0</span>&nbsp;<small class="text-muted">Cajas</small></div>
                                <svg class="icon-lg caja-hd"></svg>
                              </div>
                            </td>
                            <td>Caja</td>
                          </tr>
                          <tr id="product_item_2" class="row-item-added family-frutas-y-verduras">
                            <th scope="row"><div>1</div></th>
                            <td class="row-item-id">
                                <div>
                                    <svg class="icon-xl2 pan-hd"></svg>
                                </div>
                                <p>Pan</p>
                            </td>
                            <td>Panadería</td>
                            <td>Pan de molde</td>
                            <td class="row-item-count hide-input">
                              <div class="input-group">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-info" type="button"><div>+</div></button>
                                </div>
                                <input id="product_item_2_count" type="number" class="form-control" placeholder="Ingresar cantidad" aria-label="Conjunto de botónes para producto" aria-describedby="Conjunto de botónes para cantidad de unidades" value="0">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-danger" type="button"><div>-</div></button>
                                </div>
                              </div>
                              <div class="my-2">
                                <div>x <span>0</span>&nbsp;<small class="text-muted">Bolsas</small></div>
                                <svg class="icon-lg bolsa-hd"></svg>
                              </div>
                            </td>
                            <td>Bolsa</td>
                          </tr>
                          <tr id="product_item_3" class="row-item-added family-frutas-y-verduras">
                            <th scope="row"><div>1</div></th>
                            <td class="row-item-id">
                                <div>
                                    <svg class="icon-xl2 carne-hd"></svg>
                                </div>
                                <p>Carne</p>
                            </td>
                            <td>Carnes</td>
                            <td>Carne roja</td>
                            <td class="row-item-count hide-input">
                              <div class="input-group">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-info" type="button"><div>+</div></button>
                                </div>
                                <input id="product_item_3_count" type="number" class="form-control" placeholder="Ingresar cantidad" aria-label="Conjunto de botónes para producto" aria-describedby="Conjunto de botónes para cantidad de unidades" value="0">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-danger" type="button"><div>-</div></button>
                                </div>
                              </div>
                              <div class="my-2">
                                <div>x <span>0</span>&nbsp;<small class="text-muted">Kilogramos</small></div>
                                <svg class="icon-lg kilogramos-hd"></svg>
                              </div>
                            </td>
                            <td>Kilogramos</td>
                          </tr>
                          <tr id="product_item_4" class="row-item-added family-frutas-y-verduras">
                            <th scope="row"><div>1</div></th>
                            <td class="row-item-id">
                                <div>
                                    <svg class="icon-xl2 galletas-hd"></svg>
                                </div>
                                <p>Galletas</p>
                            </td>
                            <td>Dulcería</td>
                            <td>Galletas</td>
                            <td class="row-item-count hide-input">
                              <div class="input-group">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-info" type="button"><div>+</div></button>
                                </div>
                                <input id="product_item_4_count" type="number" class="form-control" placeholder="Ingresar cantidad" aria-label="Conjunto de botónes para producto" aria-describedby="Conjunto de botónes para cantidad de unidades" value="0">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-danger" type="button"><div>-</div></button>
                                </div>
                              </div>
                              <div class="my-2">
                                <div>x <span>0</span>&nbsp;<small class="text-muted">Paquetes</small></div>
                                <svg class="icon-lg paquete-hd"></svg>
                              </div>
                            </td>
                            <td>Paquete</td>
                          </tr>
                          <tr id="product_item_5" class="row-item-added family-frutas-y-verduras">
                            <th scope="row"><div>1</div></th>
                            <td class="row-item-id">
                                <div>
                                    <svg class="icon-xl2 queso-hd"></svg>
                                </div>
                                <p>Queso</p>
                            </td>
                            <td>Lácteos</td>
                            <td>Quesos</td>
                            <td class="row-item-count hide-input">
                              <div class="input-group">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-info" type="button"><div>+</div></button>
                                </div>
                                <input id="product_item_5_count" type="number" class="form-control" placeholder="Ingresar cantidad" aria-label="Conjunto de botónes para producto" aria-describedby="Conjunto de botónes para cantidad de unidades" value="0">
                                <div class="input-group-prepend">
                                  <button class="btn btn-outline-danger" type="button"><div>-</div></button>
                                </div>
                              </div>
                              <div class="my-2">
                                <div>x <span>0</span>&nbsp;<small class="text-muted">Piezas</small></div>
                                <svg class="icon-lg pieza-hd"></svg>
                              </div>
                            </td>
                            <td>Pieza</td>
                          </tr>
                        </tbody>
                      </table>
                </div>
                <div class="tab-pane fade" id="most-asked-product-table" role="tabpanel" aria-labelledby="most-asked-product-table-tab">
                    <h5 class="card-title">Más solicitados</h5>
                    <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                    <a href="#" class="btn btn-primary">Go somewhere</a>
                </div>
                <div class="tab-pane fade" id="less-asked-product-table" role="tabpanel" aria-labelledby="less-asked-product-table-tab">
                    <h5 class="card-title">Menos solicitados</h5>
                    <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                    <a href="#" class="btn btn-primary">Go somewhere</a>
                </div>
                <div class="tab-pane fade" id="match-failed-product-table" role="tabpanel" aria-labelledby="match-failed-product-table-tab">
                    <h5 class="card-title">Productos que más fallan en coincidencias</h5>
                    <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                    <a href="#" class="btn btn-primary">Go somewhere</a>
                </div>
            </div>
          </div>
    </div>
    <script>
      // Obtener la lista UL
      const order_table = document.getElementById('order-table');

      // Obtener todos los elementos LI de la lista
      const items_tr = order_table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');

      // Recorrer cada elemento LI y agregar el evento de clic
      for (let i = 0; i < items_tr.length; i++) {
        
        // Permite mostrar u ocultar los campos para añadir productos
        items_tr[i].getElementsByClassName('row-item-count')[0].children[1].addEventListener('click', function() {
          this.parentElement.classList.toggle('hide-input');
          this.parentElement.classList.toggle('show-input');
        });
        // Permite SUMAR productos
        function sum_Product(element) {
          let id = element.parentElement.parentElement.parentElement.parentElement.id;
          let input_count = element.parentElement.parentElement.querySelector('#'+id+'_count');
          let tag_count = element.parentElement.parentElement.parentElement.children[1].children[0].children[0];
          input_count.value = parseInt(input_count.value) + 1;
          tag_count.innerHTML = input_count.value;
        }
        items_tr[i].getElementsByClassName('row-item-count')[0].children[0].children[0].children[0].addEventListener('click', function() {
          sum_Product(this);
        });
        // Permite ELIMINAR productos
        function del_Product(element) {
          let id = element.parentElement.parentElement.parentElement.parentElement.id;
          let input_count = element.parentElement.parentElement.querySelector('#'+id+'_count');
          let tag_count = element.parentElement.parentElement.parentElement.children[1].children[0].children[0];
          if (input_count.value > 0) {
            input_count.value = parseInt(input_count.value) - 1;
            tag_count.innerHTML = input_count.value;
          }
        }
        items_tr[i].getElementsByClassName('row-item-count')[0].children[0].children[2].children[0].addEventListener('click', function() {
          del_Product(this);
        });
      }
    </script>
</body>
</html>